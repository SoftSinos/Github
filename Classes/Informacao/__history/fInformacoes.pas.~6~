unit fInformacoes;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.Buttons, Vcl.ExtCtrls;

type
  TFrmInformacoes = class(TForm)
    MemInformacoes: TMemo;
    PnlPrincipal  : TPanel;
    BtnFechar     : TSpeedButton;
    procedure FormShow(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure BtnFecharClick(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  FrmInformacoes: TFrmInformacoes;

implementation

{$R *.dfm}

uses dPrincipal, uConfiguracao;

var
  unConfiguracao : TConfiguracao;

procedure TFrmInformacoes.BtnFecharClick(Sender: TObject);
begin
  Close;
end;

procedure TFrmInformacoes.FormClose(Sender: TObject; var Action: TCloseAction);
begin
  Action := caFree;
end;

procedure TFrmInformacoes.FormCreate(Sender: TObject);
begin
  unConfiguracao := TConfiguracao.Create;
end;

procedure TFrmInformacoes.FormShow(Sender: TObject);
var
  NrExpiracao : String;
  DtExpiracao : String;
begin

  //TEMPO DE DURACAO CONTRA SENHA "SAFERY OPEN"
  unConfiguracao.Buscar(DtmPrincipal.Conexao, DtmPrincipal.IdEmpresaLogada, 'TDCS');
  NrExpiracao := Copy(unConfiguracao.NmValor, 6, 5);
  DtExpiracao := DateTimeToStr(StrToInt(NrExpiracao));

  MemInformacoes.Lines.Add('INFORMAÇÕES DO SISTEMA');
  MemInformacoes.Lines.Add('');
  MemInformacoes.Lines.Add('');
  MemInformacoes.Lines.Add('Versão do Programa: ' + DtmPrincipal.NrVersaoApp);
  MemInformacoes.Lines.Add('Local do Programa: ' + DtmPrincipal.NmCaminhoExecutavel);
  MemInformacoes.Lines.Add('Data da Versão: ' +  DtmPrincipal.DtVersaoApp);
  MemInformacoes.Lines.Add('');
  MemInformacoes.Lines.Add('Servidor: ' + DtmPrincipal.NmHost);
  MemInformacoes.Lines.Add('Bando de Dados: ' + DtmPrincipal.NmBanco);
  MemInformacoes.Lines.Add('Versão do Banco de Dados: ' + DtmPrincipal.NrVersaoBd);
  MemInformacoes.Lines.Add('');
  MemInformacoes.Lines.Add('Certificado Valido até: ' + DtExpiracao);
end;

end.
